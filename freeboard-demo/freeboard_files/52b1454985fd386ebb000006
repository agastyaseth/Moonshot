(function(){var d=100;var f=["#FF9900","#FFFFFF","#13F7F9","#6B6B6B","#28DE28","#E6EE18","#C41204","#CA3CB8","#0B1CFB","#813CCA"];freeboard.addStyle(".gauge-widget-wrapper","width: 100%;text-align: center;");freeboard.addStyle(".gauge-widget","width:200px;height:160px;display:inline-block;");freeboard.addStyle(".sparkline","width:100%;height: 90px;margin-top:5px;");freeboard.addStyle(".indicator-light","border-radius:50%;width:22px;height:22px;border:2px solid #3d3d3d;margin-top:5px;float:left;background-color:#222;margin-right:10px;");freeboard.addStyle(".indicator-light.on","background-color:#FFC773;box-shadow: 0px 0px 15px #FF9900;border-color:#FDF1DF;");freeboard.addStyle(".indicator-text","margin-top:10px;");freeboard.addStyle(".text-widget-big-value","font-size:75px;");freeboard.addStyle("div.pointer-value","position:absolute;height:95px;margin:auto;top: 0px;bottom: 0px;width: 100%;text-align:center;");function c(l,h,k){var i=$(h).text();if(i==l){return}if($.isNumeric(l)&&$.isNumeric(i)){var n=l.toString().split(".");var j=0;if(n.length>1){j=n[1].length}n=i.toString().split(".");var m=0;if(n.length>1){m=n[1].length}jQuery({transitionValue:Number(i),precisionValue:m}).animate({transitionValue:Number(l),precisionValue:j},{duration:k,step:function(){$(h).text(this.transitionValue.toFixed(this.precisionValue))},done:function(){$(h).text(l)}})}else{$(h).text(l)}}function e(m,n){var h=$("<div class='sparkline-legend'></div>");for(var l=0;l<n.length;l++){var j=f[l%f.length];var k=n[l];h.append("<div class='sparkline-legend-value'><span style='color:"+j+"'>&#9679;</span>"+k+"</div>")}m.empty().append(h);freeboard.addStyle(".sparkline-legend","margin:5px;");freeboard.addStyle(".sparkline-legend-value","color:white; font:10px arial,san serif; float:left; overflow:hidden; width:50%;");freeboard.addStyle(".sparkline-legend-value span","font-weight:bold; padding-right:5px;")}function b(i,l,m){var o=$(i).data().values;var j=$(i).data().valueMin;var p=$(i).data().valueMax;if(!o){o=[];j=undefined;p=undefined}var h=function(r,q){if(!o[q]){o[q]=[]}if(o[q].length>=d){o[q].shift()}if(r!=undefined){o[q].push(Number(r))}if(j===undefined||r<j){j=r}if(p===undefined||r>p){p=r}};if(_.isArray(l)){_.each(l,h)}else{h(l,0)}$(i).data().values=o;$(i).data().valueMin=j;$(i).data().valueMax=p;var k='<span style="color: {{color}}">&#9679;</span> {{y}}';var n=false;_.each(o,function(q,r){$(i).sparkline(q,{type:"line",composite:n,height:"100%",width:"100%",fillColor:false,lineColor:f[r%f.length],lineWidth:2,spotRadius:3,spotColor:false,minSpotColor:"#78AB49",maxSpotColor:"#78AB49",highlightSpotColor:"#9D3926",highlightLineColor:"#9D3926",chartRangeMin:j,chartRangeMax:p,tooltipFormat:(m&&m[r])?k+" ("+m[r]+")":k});n=true})}var a=freeboard.getStyleString("values");freeboard.addStyle(".widget-big-text",a+"font-size:75px;");freeboard.addStyle(".tw-display","width: 100%; height:100%; display:table; table-layout:fixed;");freeboard.addStyle(".tw-tr","display:table-row;");freeboard.addStyle(".tw-tg","display:table-row-group;");freeboard.addStyle(".tw-tc","display:table-caption;");freeboard.addStyle(".tw-td","display:table-cell;");freeboard.addStyle(".tw-value","font-weight: 100;overflow: hidden;display: inline-block;text-overflow: ellipsis;");freeboard.addStyle(".tw-unit","display: inline-block;padding-left: 10px;padding-bottom: 1.1em;vertical-align: bottom;");freeboard.addStyle(".tw-value-wrapper","position: relative;vertical-align: middle;height:100%;");freeboard.addStyle(".tw-sparkline","height:20px;");window.text_widget=function(j){var p=this;var h=j;var n=$('<div class="tw-display"></div>');var k=$('<h2 class="section-title tw-title tw-td"></h2>');var o=$('<div class="tw-value"></div>');var m=$('<div class="tw-unit"></div>');var i=$('<div class="tw-sparkline tw-td"></div>');function l(){if(!_.isUndefined(h.units)&&h.units!=""){o.css("max-width",(n.innerWidth()-m.outerWidth(true))+"px")}else{o.css("max-width","100%")}}this.render=function(q){$(q).empty();$(n).append($('<div class="tw-tr"></div>').append(k)).append($('<div class="tw-tr"></div>').append($('<div class="tw-value-wrapper tw-td"></div>').append(o).append(m))).append($('<div class="tw-tr"></div>').append(i));$(q).append(n);l()};this.onSettingsChanged=function(q){h=q;var t=(!_.isUndefined(q.title)&&q.title!="");var r=(!_.isUndefined(q.units)&&q.units!="");if(q.sparkline){i.attr("style",null)}else{delete i.data().values;i.empty();i.hide()}if(t){k.html((_.isUndefined(q.title)?"":q.title));k.attr("style",null)}else{k.empty();k.hide()}if(r){m.html((_.isUndefined(q.units)?"":q.units));m.attr("style",null)}else{m.empty();m.hide()}var s=30;if(q.size=="big"){s=75;if(q.sparkline){s=60}}o.css({"font-size":s+"px"});l()};this.onSizeChanged=function(){l()};this.onCalculatedValueChanged=function(q,r){if(q=="value"){if(h.animate){c(r,o,500)}else{o.text(r)}if(h.sparkline){b(i,r)}}};this.onDispose=function(){};this.getHeight=function(){if(h.size=="big"||h.sparkline){return 2}else{return 1}};this.onSettingsChanged(j)};var g=0;window.gauge_widget=function(m){var p=this;var i="gauge-"+g++;var n=$('<h2 class="section-title"></h2>');var l=$('<div class="gauge-widget" id="'+i+'"></div>');var j;var k=false;var h=m;function o(){if(!k){return}l.empty();j=new JustGage({id:i,value:(_.isUndefined(h.min_value)?0:h.min_value),min:(_.isUndefined(h.min_value)?0:h.min_value),max:(_.isUndefined(h.max_value)?0:h.max_value),label:h.units,showInnerShadow:false,valueFontColor:"#d3d4d4"})}this.render=function(q){k=true;$(q).append(n).append($('<div class="gauge-widget-wrapper"></div>').append(l));o()};this.onSettingsChanged=function(q){if(q.min_value!=h.min_value||q.max_value!=h.max_value||q.units!=h.units){h=q;o()}else{h=q}n.html(q.title)};this.onCalculatedValueChanged=function(q,r){if(!_.isUndefined(j)){j.refresh(Number(r))}};this.onDispose=function(){};this.getHeight=function(){return 3};this.onSettingsChanged(m)};window.sparkline_widget=function(k){var j=this;var l=$('<h2 class="section-title"></h2>');var m=$('<div class="sparkline"></div>');var h=$("<div></div>");var i=k;this.render=function(n){$(n).append(l).append(m).append(h)};this.onSettingsChanged=function(n){i=n;l.html((_.isUndefined(n.title)?"":n.title));if(n.include_legend){e(h,n.legend.split(","))}};this.onCalculatedValueChanged=function(n,o){if(i.legend){b(m,o,i.legend.split(","))}else{b(m,o)}};this.onDispose=function(){};this.getHeight=function(){var n=0;if(i.include_legend&&i.legend){var o=i.legend.split(",").length;if(o>4){n=Math.floor((o-1)/4)*0.5}else{if(o){n=0.5}}}return 2+n};this.onSettingsChanged(k)};window.pointer_widget=function(k){var q=this;var j;var m=3;var l;var h,p;var o=0;var i=$('<div class="widget-big-text"></div>');var n=$("<div></div>");function r(t){if(!t||t.length<2){return[]}var u=[];u.push(["m",t[0],t[1]]);for(var s=2;s<t.length;s+=2){u.push(["l",t[s],t[s+1]])}u.push(["z"]);return u}this.render=function(t){h=$(t).width();p=235;var s=Math.min(h,p)/2-m*2;j=Raphael($(t).get()[0],h,p);var u=j.circle(h/2,p/2,s);u.attr("stroke","#FF9900");u.attr("stroke-width",m);l=j.path(r([h/2,(p/2)-s+m,15,20,-30,0]));l.attr("stroke-width",0);l.attr("fill","#fff");$(t).append($('<div class="pointer-value"></div>').append(i).append(n))};this.onSettingsChanged=function(s){n.html(s.units)};this.onCalculatedValueChanged=function(t,v){if(t=="direction"){if(!_.isUndefined(l)){var u="r";var s=o+180;if(s<v){}l.animate({transform:"r"+v+","+(h/2)+","+(p/2)},250,"bounce")}o=v}else{if(t=="value_text"){i.html(v)}}};this.onDispose=function(){};this.getHeight=function(){return 4};this.onSettingsChanged(k)};window.indicator_widget=function(i){var q=this;var l=$('<h2 class="section-title"></h2>');var k=$('<div class="indicator-text"></div>');var m=$('<div class="indicator-light"></div>');var h=i;var j=false;var n;var p;function o(){m.toggleClass("on",j);if(j){k.text((_.isUndefined(n)?(_.isUndefined(h.on_text)?"":h.on_text):n))}else{k.text((_.isUndefined(p)?(_.isUndefined(h.off_text)?"":h.off_text):p))}}this.render=function(r){$(r).append(l).append(m).append(k)};this.onSettingsChanged=function(r){h=r;l.html((_.isUndefined(r.title)?"":r.title));o()};this.onCalculatedValueChanged=function(r,s){if(r=="value"){j=Boolean(s)}if(r=="on_text"){n=s}if(r=="off_text"){p=s}o()};this.onDispose=function(){};this.getHeight=function(){return 1};this.onSettingsChanged(i)}}());